<!-- 
Swagger Documentation Preview for Staff Creation API

This shows how the API documentation will appear in Swagger UI
Visit: http://localhost:3000/api-docs to see the interactive documentation
-->\n\n# Staff Creation API - Swagger Documentation\n\n## Endpoint Overview\n**POST** `/api/v1/users/staff`\n\n**Tags:** Staff Management  \n**Summary:** Create a new staff user  \n**Authentication:** Bearer Token Required\n\n## Request Schema\n\n### StaffCreateRequest\n```json\n{\n  \"type\": \"object\",\n  \"required\": [\n    \"tenantId\",\n    \"clinicId\", \n    \"name\",\n    \"phoneNumber\",\n    \"email\",\n    \"username\",\n    \"password\",\n    \"roleId\"\n  ],\n  \"properties\": {\n    \"tenantId\": {\n      \"type\": \"string\",\n      \"description\": \"Valid tenant ID\",\n      \"example\": \"tenant-123\"\n    },\n    \"clinicId\": {\n      \"type\": \"string\", \n      \"description\": \"Valid clinic ID\",\n      \"example\": \"clinic-456\"\n    },\n    \"name\": {\n      \"type\": \"string\",\n      \"minLength\": 2,\n      \"maxLength\": 100,\n      \"description\": \"Full name of the staff member\",\n      \"example\": \"John Doe\"\n    },\n    \"phoneNumber\": {\n      \"type\": \"string\",\n      \"pattern\": \"^[0-9]{10,15}$\",\n      \"description\": \"Phone number (10-15 digits)\",\n      \"example\": \"1234567890\"\n    },\n    \"email\": {\n      \"type\": \"string\",\n      \"format\": \"email\",\n      \"description\": \"Valid email address\",\n      \"example\": \"john.doe@example.com\"\n    },\n    \"username\": {\n      \"type\": \"string\",\n      \"minLength\": 3,\n      \"maxLength\": 50,\n      \"pattern\": \"^[a-zA-Z0-9_]+$\",\n      \"description\": \"Username (alphanumeric and underscores only)\",\n      \"example\": \"johndoe_staff\"\n    },\n    \"password\": {\n      \"type\": \"string\",\n      \"minLength\": 8,\n      \"pattern\": \"^(?=.*[a-z])(?=.*[A-Z])(?=.*\\\\d)(?=.*[@$!%*?&])[A-Za-z\\\\d@$!%*?&]\",\n      \"description\": \"Password (must contain uppercase, lowercase, number, and special character)\",\n      \"example\": \"SecurePass123!\"\n    },\n    \"sex\": {\n      \"type\": \"string\",\n      \"enum\": [\"MALE\", \"FEMALE\", \"OTHER\"],\n      \"description\": \"Gender (optional)\",\n      \"example\": \"MALE\"\n    },\n    \"roleId\": {\n      \"type\": \"string\",\n      \"description\": \"Valid role ID\", \n      \"example\": \"role-staff-id\"\n    }\n  }\n}\n```\n\n## Response Examples\n\n### 201 Created - Staff User (with Person record)\n```json\n{\n  \"success\": true,\n  \"message\": \"User created successfully\",\n  \"data\": {\n    \"user\": {\n      \"id\": \"user-789\",\n      \"username\": \"johndoe_staff\",\n      \"emailId\": \"john.doe@example.com\",\n      \"mobileNumber\": \"1234567890\",\n      \"tenantId\": \"tenant-123\",\n      \"personId\": \"person-456\",\n      \"createdAt\": \"2025-11-21T10:30:00.000Z\"\n    },\n    \"person\": {\n      \"id\": \"person-456\",\n      \"tenantId\": \"tenant-123\", \n      \"type\": \"USER\",\n      \"fullName\": \"John Doe\",\n      \"phone\": \"1234567890\",\n      \"email\": \"john.doe@example.com\",\n      \"sex\": \"MALE\",\n      \"createdAt\": \"2025-11-21T10:30:00.000Z\"\n    },\n    \"userRole\": {\n      \"id\": \"userrole-123\",\n      \"userId\": \"user-789\",\n      \"roleId\": \"role-staff-id\",\n      \"priority\": 1\n    },\n    \"userClinic\": {\n      \"id\": \"userclinic-456\",\n      \"userId\": \"user-789\",\n      \"clinicId\": \"clinic-456\",\n      \"roleInClinic\": \"STAFF\"\n    }\n  }\n}\n```\n\n### 201 Created - Non-Staff User (no Person record)\n```json\n{\n  \"success\": true,\n  \"message\": \"User created successfully\",\n  \"data\": {\n    \"user\": {\n      \"id\": \"user-890\",\n      \"username\": \"janeadmin\",\n      \"emailId\": \"jane.admin@example.com\",\n      \"mobileNumber\": \"0987654321\",\n      \"tenantId\": \"tenant-123\",\n      \"personId\": null,\n      \"createdAt\": \"2025-11-21T10:30:00.000Z\"\n    },\n    \"person\": null,\n    \"userRole\": {\n      \"id\": \"userrole-124\",\n      \"userId\": \"user-890\", \n      \"roleId\": \"role-admin-id\",\n      \"priority\": 2\n    },\n    \"userClinic\": {\n      \"id\": \"userclinic-457\",\n      \"userId\": \"user-890\",\n      \"clinicId\": \"clinic-456\",\n      \"roleInClinic\": \"STAFF\"\n    }\n  }\n}\n```\n\n### Error Responses\n\n#### 400 Bad Request - Validation Error\n```json\n{\n  \"success\": false,\n  \"message\": \"Email must be valid\",\n  \"error\": \"Validation failed on email field\"\n}\n```\n\n#### 409 Conflict - Username Exists\n```json\n{\n  \"success\": false,\n  \"message\": \"Username already exists\",\n  \"error\": \"User with this username is already registered\"\n}\n```\n\n#### 401 Unauthorized\n```json\n{\n  \"success\": false,\n  \"message\": \"Unauthorized\",\n  \"error\": \"Missing or invalid JWT token\"\n}\n```\n\n## Interactive Features in Swagger UI\n\n1. **Try It Out Button**: Test the API directly from the documentation\n2. **Request Examples**: Multiple examples showing different scenarios  \n3. **Schema Validation**: Real-time validation of request body\n4. **Response Examples**: Shows expected responses for different cases\n5. **Authentication**: Built-in JWT token management\n6. **Error Documentation**: Comprehensive error scenarios\n\n## Business Logic Documentation\n\nThe Swagger documentation includes detailed descriptions of:\n- **Role-based Person Creation**: Only creates Person records for \"STAFF\" role\n- **Transaction Safety**: All operations in atomic database transaction\n- **Security Features**: Password hashing, JWT auth, input validation\n- **Uniqueness Validation**: Username, email, phone number checks\n- **Database Relationships**: User-Person-Role-Clinic linking\n\n## Access the Documentation\n\n1. Start your server: `npm run dev`\n2. Navigate to: `http://localhost:3000/api-docs`\n3. Find \"Staff Management\" section\n4. Click on \"POST /users/staff\" endpoint\n5. Use \"Try it out\" to test the API\n\nThe documentation provides a complete interactive experience for developers to understand and test the staff creation functionality.